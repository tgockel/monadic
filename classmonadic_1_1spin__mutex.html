<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>monadic++: monadic::spin_mutex Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">monadic++
   </div>
   <div id="projectbrief">Experimental Monadic C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('classmonadic_1_1spin__mutex.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classmonadic_1_1spin__mutex-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">monadic::spin_mutex Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>A mutex type which spins on an atomic bool instead of relying on OS functions.  
 <a href="classmonadic_1_1spin__mutex.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="spin__mutex_8hpp_source.html">monadic/spin_mutex.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a4479bbab84e53a01c684c0fc36377f50"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4479bbab84e53a01c684c0fc36377f50"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>native_handle_type</b> = std::atomic&lt; bool &gt; *</td></tr>
<tr class="separator:a4479bbab84e53a01c684c0fc36377f50"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a5f535ea738330bf118a2d31394ee230d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5f535ea738330bf118a2d31394ee230d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>spin_mutex</b> (const <a class="el" href="classmonadic_1_1spin__mutex.html">spin_mutex</a> &amp;)=delete</td></tr>
<tr class="separator:a5f535ea738330bf118a2d31394ee230d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a292e84c50e5c9a1b3d199b776458477e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a292e84c50e5c9a1b3d199b776458477e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>spin_mutex</b> (<a class="el" href="classmonadic_1_1spin__mutex.html">spin_mutex</a> &amp;&amp;)=delete</td></tr>
<tr class="separator:a292e84c50e5c9a1b3d199b776458477e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac609fc5b257c274c2ada18df4de5d3e6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac609fc5b257c274c2ada18df4de5d3e6"></a>
<a class="el" href="classmonadic_1_1spin__mutex.html">spin_mutex</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (const <a class="el" href="classmonadic_1_1spin__mutex.html">spin_mutex</a> &amp;)=delete</td></tr>
<tr class="separator:ac609fc5b257c274c2ada18df4de5d3e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf699efe3aace6980d97f30dd7912ea7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acf699efe3aace6980d97f30dd7912ea7"></a>
<a class="el" href="classmonadic_1_1spin__mutex.html">spin_mutex</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>operator=</b> (<a class="el" href="classmonadic_1_1spin__mutex.html">spin_mutex</a> &amp;&amp;)=delete</td></tr>
<tr class="separator:acf699efe3aace6980d97f30dd7912ea7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9cefb3abe5c0cf1d4fccad4e9317135"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmonadic_1_1spin__mutex.html#ac9cefb3abe5c0cf1d4fccad4e9317135">try_lock</a> ()</td></tr>
<tr class="memdesc:ac9cefb3abe5c0cf1d4fccad4e9317135"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempt to lock this mutex.  <a href="#ac9cefb3abe5c0cf1d4fccad4e9317135">More...</a><br /></td></tr>
<tr class="separator:ac9cefb3abe5c0cf1d4fccad4e9317135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00314843ae968065cff617e243071ea9"><td class="memTemplParams" colspan="2">template&lt;typename TClock , typename TDuration &gt; </td></tr>
<tr class="memitem:a00314843ae968065cff617e243071ea9"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classmonadic_1_1spin__mutex.html#a00314843ae968065cff617e243071ea9">try_lock_until</a> (const std::chrono::time_point&lt; TClock, TDuration &gt; &amp;expiry_time)</td></tr>
<tr class="memdesc:a00314843ae968065cff617e243071ea9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempt to acquire the lock on this mutex until the specified <em>expiry_time</em>.  <a href="#a00314843ae968065cff617e243071ea9">More...</a><br /></td></tr>
<tr class="separator:a00314843ae968065cff617e243071ea9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0692d0fd5213725661056a0cf42ca0d4"><td class="memTemplParams" colspan="2">template&lt;typename TRep , typename TPeriod &gt; </td></tr>
<tr class="memitem:a0692d0fd5213725661056a0cf42ca0d4"><td class="memTemplItemLeft" align="right" valign="top">bool&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classmonadic_1_1spin__mutex.html#a0692d0fd5213725661056a0cf42ca0d4">try_lock_for</a> (const std::chrono::duration&lt; TRep, TPeriod &gt; &amp;duration)</td></tr>
<tr class="memdesc:a0692d0fd5213725661056a0cf42ca0d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempt to acquire the lock on this mutex for the specified <em>duration</em>.  <a href="#a0692d0fd5213725661056a0cf42ca0d4">More...</a><br /></td></tr>
<tr class="separator:a0692d0fd5213725661056a0cf42ca0d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f412cbfe6dc1e2c3cb7b2845e930564"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmonadic_1_1spin__mutex.html#a2f412cbfe6dc1e2c3cb7b2845e930564">try_lock_spins</a> (std::size_t spins)</td></tr>
<tr class="memdesc:a2f412cbfe6dc1e2c3cb7b2845e930564"><td class="mdescLeft">&#160;</td><td class="mdescRight">Attempt to acquire the lock for the specified number of <em>spins</em>.  <a href="#a2f412cbfe6dc1e2c3cb7b2845e930564">More...</a><br /></td></tr>
<tr class="separator:a2f412cbfe6dc1e2c3cb7b2845e930564"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f4ad70bad07fd27b01157697b9cfdfe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmonadic_1_1spin__mutex.html#a0f4ad70bad07fd27b01157697b9cfdfe">lock</a> ()</td></tr>
<tr class="memdesc:a0f4ad70bad07fd27b01157697b9cfdfe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Repeatedly attempt to acquire a lock on this mutex in a while loop.  <a href="#a0f4ad70bad07fd27b01157697b9cfdfe">More...</a><br /></td></tr>
<tr class="separator:a0f4ad70bad07fd27b01157697b9cfdfe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c788910aa4cd78430d2820cb20aebea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmonadic_1_1spin__mutex.html#a0c788910aa4cd78430d2820cb20aebea">unlock</a> ()</td></tr>
<tr class="memdesc:a0c788910aa4cd78430d2820cb20aebea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Unlock this mutex.  <a href="#a0c788910aa4cd78430d2820cb20aebea">More...</a><br /></td></tr>
<tr class="separator:a0c788910aa4cd78430d2820cb20aebea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ffd66a9136f4cf27bbe70d755671d88"><td class="memItemLeft" align="right" valign="top">native_handle_type&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmonadic_1_1spin__mutex.html#a4ffd66a9136f4cf27bbe70d755671d88">native_handle</a> ()</td></tr>
<tr class="memdesc:a4ffd66a9136f4cf27bbe70d755671d88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get a pointer to the atomic variable that backs this mutex.  <a href="#a4ffd66a9136f4cf27bbe70d755671d88">More...</a><br /></td></tr>
<tr class="separator:a4ffd66a9136f4cf27bbe70d755671d88"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A mutex type which spins on an atomic bool instead of relying on OS functions. </p>
<p>When your work unit takes less time than your OS's quantum and your lock has low contention, a spin mutex can be faster than a regular mutex. </p>

<p>Definition at line <a class="el" href="spin__mutex_8hpp_source.html#l00024">24</a> of file <a class="el" href="spin__mutex_8hpp_source.html">spin_mutex.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a0f4ad70bad07fd27b01157697b9cfdfe"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void monadic::spin_mutex::lock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Repeatedly attempt to acquire a lock on this mutex in a while loop. </p>

<p>Definition at line <a class="el" href="spin__mutex_8hpp_source.html#l00103">103</a> of file <a class="el" href="spin__mutex_8hpp_source.html">spin_mutex.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a4ffd66a9136f4cf27bbe70d755671d88"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">native_handle_type monadic::spin_mutex::native_handle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get a pointer to the atomic variable that backs this mutex. </p>
<p>Please do not edit it. </p>

<p>Definition at line <a class="el" href="spin__mutex_8hpp_source.html#l00116">116</a> of file <a class="el" href="spin__mutex_8hpp_source.html">spin_mutex.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac9cefb3abe5c0cf1d4fccad4e9317135"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool monadic::spin_mutex::try_lock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attempt to lock this mutex. </p>
<p>When the lock is acquired, there is a sequentially-consistent guarantee. If the lock is not acquired, there is no memory ordering guarantee.</p>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the lock was obtained; <code>false</code> if it was not (someone else holds the lock). </dd></dl>

<p>Definition at line <a class="el" href="spin__mutex_8hpp_source.html#l00044">44</a> of file <a class="el" href="spin__mutex_8hpp_source.html">spin_mutex.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0692d0fd5213725661056a0cf42ca0d4"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TRep , typename TPeriod &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool monadic::spin_mutex::try_lock_for </td>
          <td>(</td>
          <td class="paramtype">const std::chrono::duration&lt; TRep, TPeriod &gt; &amp;&#160;</td>
          <td class="paramname"><em>duration</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attempt to acquire the lock on this mutex for the specified <em>duration</em>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">duration</td><td>The relative time to spin before giving up. The actual ticking time is based on <code>std::chrono::steady_clock</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the lock was obtained; <code>false</code> if it was not (someone else holds the lock). </dd></dl>

<p>Definition at line <a class="el" href="spin__mutex_8hpp_source.html#l00083">83</a> of file <a class="el" href="spin__mutex_8hpp_source.html">spin_mutex.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a2f412cbfe6dc1e2c3cb7b2845e930564"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool monadic::spin_mutex::try_lock_spins </td>
          <td>(</td>
          <td class="paramtype">std::size_t&#160;</td>
          <td class="paramname"><em>spins</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attempt to acquire the lock for the specified number of <em>spins</em>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">spins</td><td>The number of times to call <code>try_lock</code> before giving up.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the lock was obtained; <code>false</code> if it was not (someone else holds the lock). </dd></dl>

<p>Definition at line <a class="el" href="spin__mutex_8hpp_source.html#l00094">94</a> of file <a class="el" href="spin__mutex_8hpp_source.html">spin_mutex.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a00314843ae968065cff617e243071ea9"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename TClock , typename TDuration &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool monadic::spin_mutex::try_lock_until </td>
          <td>(</td>
          <td class="paramtype">const std::chrono::time_point&lt; TClock, TDuration &gt; &amp;&#160;</td>
          <td class="paramname"><em>expiry_time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Attempt to acquire the lock on this mutex until the specified <em>expiry_time</em>. </p>
<p>If the given time is in the past, this function will still attempt to acquire the lock once (this prevents the lock from becoming unobtainable on slow machines with short spin lengths).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">expiry_time</td><td>The absolute time to give up spinning at. You most likely want to use a monotonic clock (such as <code>std::chrono::steady_clock</code>) for this so you are not subject to NTP or other clock changes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>true</code> if the lock was obtained; <code>false</code> if it was not (someone else holds the lock). </dd></dl>

<p>Definition at line <a class="el" href="spin__mutex_8hpp_source.html#l00065">65</a> of file <a class="el" href="spin__mutex_8hpp_source.html">spin_mutex.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a0c788910aa4cd78430d2820cb20aebea"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void monadic::spin_mutex::unlock </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Unlock this mutex. </p>
<p>There is no checking that you actually own the mutex. </p>

<p>Definition at line <a class="el" href="spin__mutex_8hpp_source.html#l00110">110</a> of file <a class="el" href="spin__mutex_8hpp_source.html">spin_mutex.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>monadic/<a class="el" href="spin__mutex_8hpp_source.html">spin_mutex.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>monadic</b></li><li class="navelem"><a class="el" href="classmonadic_1_1spin__mutex.html">spin_mutex</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.9.1 </li>
  </ul>
</div>
</body>
</html>
